<!DOCTYPE html>
<html lang="en">

<body>
  <script src="https://cdn.jsdelivr.net/npm/gojs@3.0.21/release/go.js"></script>
  <p>
    This is a minimalist HTML and JavaScript skeleton of the GoJS Sample
    <a href="https://gojs.net/latest/samples/shapes.html">shapes.html</a>. It was automatically generated from a button
    on the sample page,
    and does not contain the full HTML. It is intended as a starting point to adapt for your own usage.
    For many samples, you may need to inspect the
    <a href="https://github.com/NorthwoodsSoftware/GoJS/blob/master/samples/shapes.html">full source on Github</a>
    and copy other files or scripts.
  </p>
  <div id="allSampleContent" class="p-4 w-full">




    <script src="https://cdn.jsdelivr.net/npm/create-gojs-kit@3.0.21/dist/extensions/Figures.js"></script>

    <div>
      <a id="shape-1" class="Rectangle" style="width: 70px; height: 70px;" draggable="true"
        ondragstart="onDragstart(event)">
        <svg
          style="left: 0px; top: 0px; width: 76px; height: 76px; display: block; position: relative; overflow: hidden; pointer-events: none;">
          <rect x="3" y="3" width="70" height="70" fill="palegreen" stroke="green" stroke-width="3">
          </rect>
        </svg>
      </a>
      <a id="shape-2" class="Circle" style="width: 76px; height: 76px;" draggable="true"
        ondragstart="onDragstart(event)">
        <svg width="76" height="76" xmlns="http://www.w3.org/2000/svg">
          <circle cx="38" cy="38" r="36" stroke="green" stroke-width="3" fill="palegreen" />
        </svg>
      </a>
    </div>
    <div id="sample">
      <div id="myDiagramDiv" style="height: 600px;background-color: #ffffff;" class="border border-black border-solid"
        ondrop="onDrop(event)" ondragover="onDragover(event)">
        <div class="text-center">
          <h2>Shapes</h2>
          <p>Drag and drop shapes from the list above to the diagram.</p>
        </div>
      </div>
      <p>
        This sample showcases all predefined <b>GoJS</b> figures. This sample also makes use of
        <a href="../intro/highlighting.html">GoJS Highlighting</a> data bindings: Mouse-hover over a
        shape to see its name.
      </p>
      <p>
        You can specify a predefined geometry for a <a>Shape</a> by setting its <a>Shape.figure</a>.
      </p>
      <p>
        In order to reduce the size of the GoJS library, most predefined figures are in the
        <a href="https://cdn.jsdelivr.net/npm/create-gojs-kit@3.0.21/dist/extensions/Figures.js"
          target="_blank">Figures.js</a> file. You can load this file
        or simply load only those figures that you want to use by copying their definitions into your
        code.
      </p>
      <p>
        A number of very common figures are predefined in go.js:
        <code>"Rectangle", "Square", "RoundedRectangle", "RoundedTopRectangle", "RoundedBottomRectangle",
      "RoundedLeftRectangle", "RoundedRightRectangle", "Border", "Ellipse", "Circle",
      "TriangleRight", "TriangleDown", "TriangleLeft", "TriangleUp", "Triangle", "Diamond", "LineH",
      "LineV", "None", "BarH", "BarV", "MinusLine", "PlusLine", "XLine", "LineRight", "LineDown",
      "LineLeft", "LineUp", "Capsule"</code>. These figures are filled green above, instead of pink.
      </p>
      <p>
        With GoJS you can also define your own custom shapes with SVG-like path syntax, see the
        <a href="icons.html">SVG icons</a> sample for examples or the
        <a href="../intro/geometry.html">Geometry Path Strings intro page</a> to learn more.
      </p>
      <p>For predefined arrowheads, see the <a href="arrowheads.html">Arrowheads</a> sample.</p>
      <p>
        For the "RoundedRectangle" figure, you can set the <a>Shape.parameter1</a> and
        <a>Shape.parameter2</a>
        values to modify the corner radius and which corners are rounded, respectively.
      </p>
      <p>
        <code>parameter2</code> is a number that is specified by four bit flags (1, 2, 4, 8), describing
        the top-left, top-right, bottom-right, and bottom-left corners respectively. The flags can be
        defined to specify which corners to round:
      </p>
      <div id="myDiagramDiv2" style="border: solid 1px black; height: 130px"></div>
    </div>

    <script id="code">
      function init() {
        myDiagram = new go.Diagram('myDiagramDiv', {
          layout: new go.GridLayout({
            cellSize: new go.Size(1, 1),
            sorting: go.GridSorting.Forwards
          }), // use a GridLayout
          padding: new go.Margin(5, 5, 25, 5) // to see the names of shapes on the bottom row
        });

        // Names of the built in shapes, which we will color green instead of pink.
        // The pink shapes are instead defined in the "https://cdn.jsdelivr.net/npm/create-gojs-kit@3.0.21/dist/extensions/Figures.js" file.
        var builtIn = [
          'Rectangle',
          'Square',
          'RoundedRectangle',
          'RoundedTopRectangle',
          'RoundedBottomRectangle',
          'RoundedLeftRectangle',
          'RoundedRightRectangle',
          'Border',
          'Ellipse',
          'Circle',
          'TriangleRight',
          'TriangleDown',
          'TriangleLeft',
          'TriangleUp',
          'Triangle',
          'Diamond',
          'LineH',
          'LineV',
          'None',
          'BarH',
          'BarV',
          'MinusLine',
          'PlusLine',
          'XLine',
          'LineRight',
          'LineDown',
          'LineLeft',
          'LineUp',
          'Capsule',
          'Borders'
        ];
        function isBuiltIn(shapeName) {
          return builtIn.indexOf(shapeName) >= 0;
        }

        myDiagram.nodeTemplate = new go.Node('Vertical', {
          mouseEnter: (e, node) => (node.isHighlighted = true),
          mouseLeave: (e, node) => (node.isHighlighted = false),
          locationSpot: go.Spot.Center, // the location is the center of the Shape
          locationObjectName: 'SHAPE',
          selectionAdorned: false, // no selection handle when selected
          resizable: true,
          resizeObjectName: 'SHAPE', // user can resize the Shape
          rotatable: true,
          rotateObjectName: 'SHAPE', // rotate the Shape without rotating the label
          // don't re-layout when node changes size
          layoutConditions: go.LayoutConditions.Standard & ~go.LayoutConditions.NodeSized
        })
          .bindObject('layerName', 'isHighlighted', (h) => (h ? 'Foreground' : ''))
          .add(
            new go.Shape({
              name: 'SHAPE', // named so that the above properties can refer to this GraphObject
              width: 70,
              height: 70,
              strokeWidth: 3
            })
              // Color the built in shapes green, and the figures.js shapes Pink
              .bind('fill', 'key', (k) => (isBuiltIn(k) ? 'palegreen' : 'lightpink'))
              .bind('stroke', 'key', (k) => (isBuiltIn(k) ? 'darkgreen' : '#C2185B'))
              // bind the Shape.figure to the figure name, which automatically gives the Shape a Geometry
              .bind('figure', 'key'),
            new go.TextBlock({ // the label
              margin: 4,
              font: 'bold 18px sans-serif',
              background: 'white'
            })
              .bindObject('visible', 'isHighlighted')
              .bind('text', 'key')
          );

        // initialize the model
        myDiagram.model.nodeDataArray = go.Shape.getFigureGenerators().toArray();

        myDiagram2 = new go.Diagram('myDiagramDiv2', {
          layout: new go.GridLayout({ sorting: go.GridSorting.Forwards }) // use a GridLayout
        });

        myDiagram2.nodeTemplate = new go.Node('Vertical')
          .add(
            new go.Shape('RoundedRectangle', {
              width: 50,
              height: 50,
              strokeWidth: 2,
              fill: 'palegreen',
              stroke: 'darkgreen',
              parameter1: 30
            })
              .bind('parameter1')
              .bind('parameter2')
          )
          .add(
            new go.TextBlock({ margin: 12, font: 'bold 12px monospace' }).bind(
              'text',
              'text',
              (val) => 'parameter2: ' + val
            )
          );
        myDiagram2.model.nodeDataArray = [
          { parameter2: 1 | 2, text: '1 | 2' },
          { parameter2: 4 | 8, text: '4 | 8' },
          { parameter2: 2 | 4, text: '2 | 4' },
          { parameter2: 1 | 8, text: '1 | 8' }
        ];
      }
      window.addEventListener('DOMContentLoaded', init);


      // Dragging and dropping nodes


      // const target = document.getElementById('myDiagramDiv');
      // target.addEventListener('drop', onDrop);
      // target.addEventListener('dragover', onDragover);

      function onDragover(e) {
        event.preventDefault();
      }
      function onDragstart(e) {
        console.log('dragstart', e);
        const shape = e.target.className;
        console.log('dragstart', e);
        event.dataTransfer.setData('text', shape);
      }
      function onDrop(e) {
        console.log('drop', e);
        e.preventDefault();
        const data = e.dataTransfer.getData('text');
        myDiagram.add(
          new go.Node("Vertical", {
            mouseEnter: (e, node) => (node.isHighlighted = true),
            mouseLeave: (e, node) => (node.isHighlighted = false),
            locationSpot: go.Spot.Center, // the location is the center of the Shape
            locationObjectName: 'SHAPE',
            selectionAdorned: false, // no selection handle when selected
            resizable: true,
            resizeObjectName: 'SHAPE', // user can resize the Shape
            rotatable: true,
            rotateObjectName: 'SHAPE', // rotate the Shape without rotating the label
            // don't re-layout when node changes size
            layoutConditions: go.LayoutConditions.Standard & ~go.LayoutConditions.NodeSized
          })
            .add(
              new go.Shape(data, { width: 70, height: 70, fill: "palegreen", stroke: "darkgreen", strokeWidth: 3 }),
            ));
        // console.log('data', data);
        // const shape = new go.Shape(data, { width: 40, height: 60, margin: 4, fill: null });
        // if (data) {
        //   // const node = myDiagram.findNodeForKey(data);
        //   // if (node) {
        //     myDiagram.startTransaction('drop');
        //     myDiagram.model.set(node.data, 'pos', myDiagram.lastInput.documentPoint);
        //     myDiagram.commitTransaction('drop');
        //   // }
        // }
      }


    </script>
  </div>
</body>

</html>